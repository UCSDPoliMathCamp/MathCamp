{
  "hash": "98b15952b8f2e95ff983d3f1f072f079",
  "result": {
    "markdown": "# Rank and Matrix Inverse\n\n## Rank of a Matrix\n\nTo determine how many solutions exist, we can use information about (1) the number of equations $m$, (2) the number of unknowns $n$, and (3) the __rank__ of the matrix representing the linear system.\n    \n__Rank__:  The maximum number of linearly independent row or column vectors in the matrix. This is equivalent to the number of nonzero rows of a matrix in row echelon form. For any matrix __A__, the row rank always equals column rank, and we refer to this number as the rank of __A__.\n\nFor example\n  $$\\begin{bmatrix} 1 & 2 & 3 \\\\\n              0 & 4 & 5 \\\\\n              0 & 0 & 6 \\end{bmatrix}$$\n            \nRank = 3\n            \n  $$\\begin{bmatrix} 1 & 2 & 3 \\\\ \n    0 & 4 & 5 \\\\\n    0 & 0 & 0 \\end{bmatrix}$$\n            \nRank = 2\n\n\n:::{#exr-rank}\n\nFind the rank of each matrix below:\n\n(Hint: transform the matrices into row echelon form. Remember that the number of nonzero rows of a matrix in row echelon form is the rank of that matrix)\n\n1. \n  $$\\begin{bmatrix} 1 & 1 & 2 \\\\ \n  2 & 1 & 3 \\\\\n  1 & 2 & 3 \\end{bmatrix}$$\n\n2.\n  $$\\begin{bmatrix} 1 & 3 & 3 & -3 & 3\\\\ \n  1 & 3 & 1 & 1 & 3 \\\\\n  1 & 3 & 2 & -1 & -2 \\\\\n  1 & 3 & 0 & 3 & -2 \\end{bmatrix}$$\n  \n:::\n\n\n\nAnswer to @exr-rank:\n\n1. rank is 2\n2. rank is 3\n\n\n## The Inverse of a Matrix\n\n\n__Identity Matrix__:  The $n\\times n$ identity matrix ${\\bf I}_n$ is the matrix whose diagonal elements are 1 and all off-diagonal elements are 0. Examples:\n            $$ {\\bf I}_2=\\begin{bmatrix} 1&0\\\\0&1 \\end{bmatrix}, \\qquad {\\bf I}_3=\\begin{bmatrix} 1&0&0\\\\ 0&1&0\\\\ \n            0&0&1 \\end{bmatrix}$$\t\n            \n            \n__Inverse Matrix__:  An $n\\times n$ matrix ${\\bf A}$ is __nonsingular__ or __invertible__ if there exists an $n\\times n$ matrix ${\\bf A}^{-1}$ such that $${\\bf A} {\\bf A}^{-1} = {\\bf A}^{-1} {\\bf A} = {\\bf I}_n$$ where ${\\bf A}^{-1}$ is the inverse of ${\\bf A}$.  If there is no such ${\\bf A}^{-1}$, then ${\\bf A}$ is singular or not invertible.\n\nExample:  Let\n        $${\\bf A} = \\begin{bmatrix} 2&3\\\\2&2 \\end{bmatrix}, \\qquad {\\bf B}=\\begin{bmatrix} -1&\\frac{3}{2}\\\\ 1&-1\n        \\end{bmatrix}$$\n        Since $${\\bf A} {\\bf B} = {\\bf B} {\\bf A} = {\\bf I}_n$$ we conclude that ${\\bf B}$ is the inverse, ${\\bf A}^{-1}$, of ${\\bf A}$ and that ${\\bf A}$ is nonsingular.\n\n__Properties of the Inverse__:\n\n- If the inverse exists, it is unique.\n\n- If ${\\bf A}$ is nonsingular, then ${\\bf A}^{-1}$ is nonsingular.\n\n- $({\\bf A}^{-1})^{-1} = {\\bf A}$\n\n- If ${\\bf A}$ and ${\\bf B}$ are nonsingular, then ${\\bf A}{\\bf B}$ is nonsingular\n\n- $({\\bf A}{\\bf B})^{-1} = {\\bf B}^{-1}{\\bf A}^{-1}$\n\n- If ${\\bf A}$ is nonsingular, then $({\\bf A}^\\top)^{-1}=({\\bf A}^{-1})^\\top$\n\n \n__Procedure to Find__ ${\\bf A}^{-1}$:  We know that if ${\\bf B}$ is the inverse of ${\\bf A}$, then $${\\bf A} {\\bf B} = {\\bf B} {\\bf A} = {\\bf I}_n$$  Looking only at the first and last parts of this $${\\bf A} {\\bf B} = {\\bf I}_n$$  Solving for ${\\bf B}$ is equivalent to solving for $n$ linear systems, where each column of ${\\bf B}$ is solved for the corresponding column in ${\\bf I}_n$.  We can solve the systems simultaneously by augmenting ${\\bf A}$ with ${\\bf I}_n$ and performing Gauss-Jordan elimination on ${\\bf A}$.  If Gauss-Jordan elimination on $[{\\bf A} | {\\bf I}_n]$ results in $[{\\bf I}_n | {\\bf B} ]$, then ${\\bf B}$ is the inverse of ${\\bf A}$.  Otherwise, ${\\bf A}$ is singular.\n\nTo summarize:  To calculate the inverse of ${\\bf A}$ \n        \n1. Form the augmented matrix $[ {\\bf A} | {\\bf I}_n]$\n\n2. Using elementary row operations, transform the augmented matrix to reduced row echelon form.\n\n3. The result of step 2 is an augmented matrix $[ {\\bf C} | {\\bf B} ]$.\n            \n    a. If ${\\bf C}={\\bf I}_n$, then ${\\bf B}={\\bf A}^{-1}$.\n            \n    b. If ${\\bf C}\\ne{\\bf I}_n$, then $\\bf C$ has a row of zeros. This means ${\\bf A}$ is singular and ${\\bf A}^{-1}$ does not exist.\n\n\n:::{#exm-inverse}\n\nFind the inverse of the following matrix:\n\n  $${\\bf A}=\\begin{bmatrix} 1&1&1\\\\0&2&3\\\\5&5&1 \\end{bmatrix}$$\n\n\n:::\n\n\n\n\n\n:::{#exr-inverse1}\n\nFind the inverse of the following matrix:\n\n  $${\\bf A}=\\begin{bmatrix} 1&0&4\\\\0&2&0\\\\0&0&1 \\end{bmatrix}$$\n\n\n:::\n\n\n\n\n## Linear Systems and Inverse\n\nLet's return to the matrix representation of a linear system \n        \n\n  $$\\bf{Ax} = \\bf{b}$$\n\n\nIf $\\bf{A}$ is an $n\\times n$ matrix,then $\\bf{Ax}=\\bf{b}$ is a system of $n$ equations in $n$ unknowns.  Suppose $\\bf{A}$ is nonsingular. Then $\\bf{A}^{-1}$ exists.  To solve this system, we can multiply each side by $\\bf{A}^{-1}$ and reduce it as follows:\n\\begin{align*} \\bf{A}^{-1} (\\bf{A} \\bf{x}) & =  \\bf{A}^{-1} \\bf{b} \\\\ (\\bf{A}^{-1} \\bf{A})\\bf{x} & =  \\bf{A}^{-1} \\bf{b}\\\\ \\bf{I}_n \\bf{x}     & =  \\bf{A}^{-1} \\bf{b}\\\\ \\bf{x} & =  \\bf{A}^{-1} \\bf{b} \\end{align*}\n\nHence, given $\\bf{A}$ and $\\bf{b}$ and given that $\\bf{A}$ is nonsingular, then $\\bf{x} = \\bf{A}^{-1} \\bf{b}$ is a unique solution to this system.\n\n\n:::{#exr-invlinsys}\n\nUse the inverse matrix to solve the following linear system:\n\n\\begin{align*} \n-3x + 4y &= 5 \\\\\n2x - y &= -10\n\\end{align*}\n\n**Hint**: the linear system above can be written in the matrix form\n\n$\\textbf{A}\\textbf{z} = \\textbf{b}$ \n  \ngiven \n\n  $$\\textbf{A} = \\begin{bmatrix} -3&4\\\\2&-1 \\end{bmatrix},$$\n\n  $$\\textbf{z} = \\begin{bmatrix} x\\\\y \\end{bmatrix},$$ \n\nand \n\n  $$\\textbf{b} = \\begin{bmatrix} 5\\\\-10 \\end{bmatrix}$$\n\n\n:::\n\n## Determinants\n\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/Ip3X9LOh2dk\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen style=\"border:1;display:block;margin:10px auto;\"></iframe>\n\n\n__Singularity__:  Determinants can be used to determine whether a square matrix is nonsingular.\n    \nA square matrix is nonsingular if and only if its determinant is not zero.\n\nDeterminant of a $1 \\times 1$ matrix, equals $|\\mathbf{A}|=|a_{11}|=a_{11}$\n\nDeterminant of a $2 \\times 2$ matrix,   \n\n$$\\mathbf{A}=\\begin{vmatrix} a_{11}&a_{12}\\\\ a_{21}&a_{22} \\end{vmatrix}$$\n\n\n\\begin{align*}\\det({\\bf A}) &= |{\\bf A}|\\\\\n        &= a_{11}|a_{22}| - a_{12}|a_{21}|\\\\\n        &= a_{11}a_{22} - a_{12}a_{21}\n\\end{align*}\n\nWe can extend the second to last equation above to get the definition of the determinant of a $3 \\times 3$ matrix:\n\\begin{align*}\n        \\begin{vmatrix} a_{11}&a_{12}&a_{13}\\\\  a_{21} & a_{22}&a_{23}\\\\ a_{31}&a_{32}&a_{33} \\end{vmatrix} \n            &= \n            a_{11} \\begin{vmatrix} a_{22}&a_{23}\\\\ a_{32}&a_{33} \\end{vmatrix}\n            - a_{12} \\begin{vmatrix} a_{21}&a_{23}\\\\ a_{31}&a_{33} \\end{vmatrix}\n            + a_{13} \\begin{vmatrix} a_{21}&a_{22}\\\\ a_{31}&a_{32} \n            \\end{vmatrix}\\\\\n            &= a_{11}(a_{22}a_{33} - a_{23}a_{32}) - a_{12}(a_{21}a_{33} - a_{23}a_{31}) + a_{13}(a_{21}a_{32} - a_{22}a_{31})\n\\end{align*}\n\nLet's extend this now to any $n\\times n$ matrix. Let's define $\\mathbf{A}_{ij}$ as the $(n-1)\\times (n-1)$ submatrix of $\\mathbf{A}$ obtained by deleting row $i$ and column $j$.  Let the $(i,j)$th __minor__ of $\\mathbf{A}$ be  the determinant of $\\mathbf{A}_{ij}$:\n\n$$M_{ij} = \\left|\\mathbf{A}_{ij}\\right|$$\n\n    \nThen for any $n\\times n$ matrix $\\mathbf{A}$\n\n$$|\\mathbf{A}| = a_{11}M_{11} - a_{12}M_{12} + \\cdots + (-1)^{n+1} a_{1n} M_{1n}$$\n\n\n\n    \nFor example, in figuring out whether the following matrix has an inverse? \n\n$$\\mathbf{A}=\\begin{bmatrix} 1&1&1\\\\0&2&3\\\\5&5&1 \\end{bmatrix}$$\n\n\n1. Calculate its determinant.\n\\begin{align*}\n|\\mathbf{A}| &= 1(2-15) - 1(0-15) + 1(0-10) \\nonumber\\\\\n&= -13+15-10 \\nonumber\\\\\n&= -8\\nonumber\n\\end{align*}\n\n2. Since $|{\\bf A}|\\ne 0$, we conclude that ${\\bf A}$ has an inverse.\n\n:::{#exr-determinants}\n\nDetermine whether the following matrices are nonsingular:\n  \n1. \n  $$\\begin{bmatrix}\n  1 & 0 & 1\\\\\n  2 & 1 & 2\\\\\n  1 & 0 & -1\n  \\end{bmatrix}$$\n              \n2. \n  $$\\begin{bmatrix}\n        2 & 1 & 2\\\\\n        1 & 0 & 1\\\\\n        4 & 1 & 4\n    \\end{bmatrix}$$\n\n:::\n\n\n## Getting Inverse of a Matrix using its Determinant\n\nThus far, we have a number of algorithms to\n\n1. Find the solution of a linear system,\n2. Find the inverse of a matrix\n\nbut these remain just that --- algorithms.  At this point, we have no way of telling how the solutions $x_j$ change as the parameters $a_{ij}$ and $b_i$ change, except by changing the values and \"rerunning\" the algorithms.\n\n\nWith determinants, we can provide an explicit formula for the inverse and\ntherefore provide an explicit formula for the solution of an $n\\times n$ linear system.\n\nHence, we can examine how changes in the parameters and $b_i$ affect the solutions $x_j$.\n\n__Determinant Formula for the Inverse of a $2 \\times 2$__: \n\nThe determinant of a $2 \\times 2$ matrix $\\mathbf{A}=\\begin{bmatrix} a & b\\\\ c & d\\\\ \\end{bmatrix}$ is defined as:\n  $$\\frac{1}{\\det({\\bf A})} \\begin{bmatrix}\n              d & -b\\\\\n              -c & a\\\\\n          \\end{bmatrix}$$\n        \n\nFor example, Let's calculate the inverse of matrix A from @exr-invlinsys using the determinant formula. \n\n\nRecall, \n\n  $$\\mathbf{A} = \\begin{bmatrix}\n              -3 & 4\\\\\n              2 & -1\\\\\n          \\end{bmatrix}$$\n          \n\n  $$\\det(\\mathbf{A}) = (-3)(-1) - (4)(2) = 3 - 8  = -5$$\n\n  \n  $$\\frac{1}{\\det(\\mathbf{A})} \\begin{bmatrix}\n              -1 & -4\\\\\n              -2 & -3\\\\\n          \\end{bmatrix}$$\n          \n  $$\\frac{1}{-5} \\begin{bmatrix}\n              -1 & -4\\\\\n              -2 & -3\\\\\n          \\end{bmatrix}$$\n          \n  $$\\begin{bmatrix}\n              \\frac{1}{5} & \\frac{4}{5}\\\\\n              \\frac{2}{5} & \\frac{3}{5}\\\\\n          \\end{bmatrix}$$\n\n\n:::{#exr-calcinverse}\n\nCaculate the inverse of $\\mathbf{A}$\n  $$\\mathbf{A} = \\begin{bmatrix}\n              3 & 5\\\\\n              -7 & 2\\\\\n          \\end{bmatrix}$$\n\n:::\n\n\n\n## Answers to Examples and Exercises {-}\n\n\n\n\nAnswer to @exr-rank:\n\n1. rank is 2\n\n2. rank is 3\n\nAnswer to @exm-inverse:\n\n$\\left(\\begin{array}{ccc|ccc}\n    1&1&1&1&0&0\\\\\n    0&2&3&0&1&0\\\\\n    5&5&1&0&0&1\n\\end{array} \\right)$\n        \n$\\left(\\begin{array}{ccc|ccc}\n    1&1&1 &1 &0&0\\\\\n    0&2&3 &0 &1&0\\\\\n    0&0&-4&-5&0&1\n\\end{array} \\right)$\n\n$\\left(\\begin{array}{ccc|ccc}\n    1&1&1&1  &0&0\\\\\n    0&2&3&0  &1&0\\\\\n    0&0&1&5/4&0&-1/4\n\\end{array} \\right)$\n\n$\\left(\\begin{array}{ccc|ccc}\n    1&1&0&-1/4 &0&1/4\\\\\n    0&2&0&-15/4&1&3/4\\\\\n    0&0&1&5/4  &0&-1/4\n\\end{array} \\right)$\n\n$\\left(\\begin{array}{ccc|ccc}\n    1&1&0&-1/4 &0  &1/4\\\\\n    0&1&0&-15/8&1/2&3/8\\\\\n    0&0&1&5/4  &0 &-1/4\n\\end{array} \\right)$\n    \n$\\left(\\begin{array}{ccc|ccc}\n    1&0&0&13/8 &-1/2&-1/8\\\\\n    0&1&0&-15/8&1/2 &3/8\\\\\n    0&0&1&5/4  &0   &-1/4\n\\end{array} \\right)$\n\n${\\bf A}^{-1} = \\left(\\begin{array}{ccc}\n    13/8 &-1/2&-1/8\\\\\n    -15/8&1/2 &3/8\\\\\n    5/4  &0   &-1/4\n\\end{array} \\right)$\n\n\nAnswer to @exr-inverse1:\n\n1. ${\\bf A}^{-1}=\\begin{bmatrix} 1&0&-4\\\\0&\\frac{1}{2}&0\\\\0&0&1 \\end{bmatrix}$\n\nAnswer to @exr-invlinsys:\n\n$\\textbf{z} = \\bf{A}^{-1} \\bf{b} = \\begin{bmatrix}\n    1/5 &4/5\\\\\n    2/5&3/5 \n\\end{bmatrix} \\begin{bmatrix}\n    5 \\\\\n    -10\n\\end{bmatrix}= \\begin{bmatrix}\n    -7 \\\\\n    -4\n\\end{bmatrix} = \\begin{bmatrix}\n    x \\\\\n    y\n\\end{bmatrix}$\n\nAnswer to @exr-determinants:\n\n1. nonsingular\n\n2. singular\n\nAnswer to @exr-calcinverse:\n\n$\\begin{bmatrix}\n            \\frac{2}{41} & \\frac{-5}{41}\\\\\n            \\frac{7}{41} & \\frac{3}{41}\\\\\n        \\end{bmatrix}$\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}