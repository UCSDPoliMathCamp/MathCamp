{
  "hash": "c01c547211f1f431c61acb5cf2d01884",
  "result": {
    "markdown": "\n# Probability Distributions {#distributions}\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-1_a9636bf51ddd7de30bb3e28a0372b967'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n## Probability Density/Mass Functions\n\nA probability density function (PDF) takes a value and returns the probability of that value for a continuous probability distribution. For discrete probability distributions, such as the binomial distribution, this is called a probability *mass* function (PMF) instead. Each common distribution in R comes with a `dfunction()` which calculates the output of a PDF/PMF for a given input. Let's take a look at the PDF/PMFs of common probability distributions.\n\n### Bernoulli Distribution {.unnumbered}\n\nThe Bernoulli distribution is a special case of the Binomial distribution where $n = 1$. It is the most commonly used type of Binomial distribution because we work with so many 0/1 variables in the social sciences.\n\n**Properties**:\n\n  - *Notation*: $X \\sim Bernoulli(p)$\n  - *PMF*: $p^k(1-p)^{1-k}$\n  - *Mean*: $\\mathbb{E}[X] = p$\n  - *Variance*: $var[X] = p(1-p)$\n  \n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-2_530a6e9b925a7805c3d8cbab9dfac584'}\n\n```{.r .cell-code}\ndf <- tibble(groups = c(\"p = 0.1\", \"p = 0.5\", \"p = 0.7\"),\n             probs = c(0.1, 0.5, 0.7)) |> \n  crossing(x = c(0, 1)) |> \n  mutate(d = dbinom(x = x, size = 1, prob = probs))\n\nbernoulli_pmf <- ggplot(df) +\n  aes(x = x, y = d) +\n  geom_bar(stat = \"identity\", width = .1) +\n  labs(y = \"Probability\") +\n  scale_x_continuous(breaks = 0:1) +\n  facet_wrap(~ groups, nrow = 3) +\n  theme_minimal()\n\nbernoulli_pmf\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nTo find the height of these bars use `dbinom(size = 1)`. For example, to find the height of the bar in the top left of the graph (i.e. the probability of 0 in $Bernoulli(p = 0.1)$) we would use:\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-3_12f85184a480feffd187771d504218f7'}\n\n```{.r .cell-code}\ndbinom(x = 0, size = 1, p = 0.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9\n```\n:::\n:::\n\n\n\n### Poisson Distribution {.unnumbered}\n\nThe Poisson distribution is used to count discrete events that occur given some underlying rate, $\\lambda$. For example, it could be used to model the prevalence of the occurrence of war over a specific time period.\n\n**Properties**:\n\n  - *Notation*: $X \\sim Poisson(\\lambda)$\n  - *PMF*: $\\frac{\\lambda^k}{k!}e^{-k}$\n  - *Mean*: $\\mathbb{E}[X] = \\lambda$\n  - *Variance*: $var[X] = \\lambda$\n  \n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-4_594215a0fee29fa3ee7d750f8f9cfd42'}\n\n```{.r .cell-code}\ndf <- tibble(groups = c(\"lambda = 0.5\", \"lambda = 2\", \"lambda = 4\", \"lambda = 8\"),\n             lambda = c(0.5, 2, 4, 8)) |> \n  crossing(x = 0:15) |> \n  mutate(d = dpois(x = x, lambda = lambda))\n\npoisson_pmf <- ggplot(df) +\n  aes(x = x, y = d) +\n  geom_bar(stat = \"identity\", width = 0.1) +\n  labs(y = \"Probability\") +\n  scale_x_continuous(breaks = 0:15) +\n  facet_wrap(~ groups) +\n  theme_minimal()\n\npoisson_pmf\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nFinding the probability for a specific value of `x`, given a poisson pdf with a specific `lambda`:\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-5_6670559d118d55810ddc7a60121f9c72'}\n\n```{.r .cell-code}\ndpois(x = 0, lambda = 0.5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6065307\n```\n:::\n:::\n\n\n### Normal Distribution {.unnumbered}\n\nThe Normal distribution is ubiquitous in statistics and arises when an outcome is the product of many small fluctuations. It has many nice mathematical qualities which make it a useful approximation even when the true distribution is somewhat different. Unlike the Bernoulli, Binomial, and Poisson distributions, the Normal distribution is *continuous*. This means that it can output any real numbered value rather than only discrete ones.\n\n**Properties**:\n\n  - *Notation*: $X \\sim Normal(\\mu, \\sigma)$\n  - *PDF*: $\\frac{1}{\\sqrt{2\\pi\\sigma^2}}\\exp[-\\frac{x-\\mu)^2}{2\\sigma^2}]$\n  - *Mean*: $\\mathbb{E}[X] = \\mu$\n  - *Variance*: $var[X] = \\sigma^2$\n\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-6_3dce8d03aa1166c81ae953a3a5888ea3'}\n\n```{.r .cell-code}\ndf <- tibble(groups = c(\"mu = 0, sigma = 1\",\n                        \"mu = 0, sigma = 2\"),\n             mu = c(0, 0),\n             sigma = c(1, 2)) |> \n  crossing(x = seq(from = -6, to = 6, length.out = 1000)) |> \n  mutate(d = dnorm(x = x, mean = mu, sd = sigma))\n\nnormal_pdf <- ggplot(df) +\n  aes(x = x, y = d) +\n  geom_line() +\n  labs(y = \"Probability\") +\n  scale_x_continuous(breaks = -6:6) +\n  facet_wrap(~groups, nrow = 2) +\n  theme_minimal()\n\nnormal_pdf\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nThe height at the curve for any value `x` tells us the probability of `x`.\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-7_b1afe13092ed97c781cc47f5cb7309ec'}\n\n```{.r .cell-code}\nstd_normal_pdf <- ggplot(df |> filter(groups == \"mu = 0, sigma = 1\",\n                                      abs(x) <= 4)) +\n  aes(x = x, y = d) +\n  geom_line() +\n  labs(y = \"Probability\", title = \"mu = 0, sigma = 1\") +\n  scale_x_continuous(breaks = -4:4) +\n  theme_minimal()\n\nstd_normal_pdf +\n  geom_segment(x = -5, y = dnorm(-1),\n               xend = -1, yend = dnorm(-1),\n               linetype = \"dashed\") +\n  geom_segment(x = -1, y = 0,\n               xend = -1, yend = dnorm(-1),\n               linetype = \"dashed\")\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nTo manually calculate the value at the dashed line above we can use:\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-8_0bcea54a0884d0d4b02580ad0466e066'}\n\n```{.r .cell-code}\ndnorm(x = 1, mean = 0, sd = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2419707\n```\n:::\n:::\n\n\n### Exponential {.unnumbered}\n\nThe Exponential distribution can be used to model an amount of time between events. It is characterized by a rate parameters, $\\lambda$ which is similar to that of the Poisson distribution. But unlike the Poisson distribution, which models discrete counts of events, the Exponential distribution is continuous. The Exponential distribution only returns positive values, which makes it useful to use as a prior distribution for something like standard deviation.\n\n**Properties**:\n\n  - *Notation*: $X \\sim Exponential(\\lambda)$\n  - *PDF*: $\\lambda e^{-\\lambda x}$\n  - *Mean*: $\\mathbb{E}[X] = \\frac{1}{\\lambda}$\n  - *Variance*: $var[X] = \\frac{1}{\\lambda^2}$\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-9_34836b75fe327a93cfae280789df9ffa'}\n\n```{.r .cell-code}\ndf <- tibble(groups = c(\"lambda = 0.5\",\n                        \"lambda = 1\",\n                        \"lambda = 1.5\"),\n             lambda = c(0.5, 1, 1.5)) |> \n  crossing(x = seq(from = 0, to = 3, length.out = 1000)) |> \n  mutate(d = dexp(x = x, rate = lambda))\n\nexponential_pdf <- ggplot(df) +\n  aes(x = x, y = d) +\n  geom_line() +\n  labs(y = \"Probability\") +\n  scale_x_continuous(breaks = 0:3) +\n  facet_wrap(~groups, nrow = 3) +\n  theme_minimal()\n\nexponential_pdf\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### Uniform {.unnumbered}\n\nThe Uniform distribution is a continuous distribution which assigns equal probability to all values between a minimum and maximum.\n\n**Properties**:\n\n  - *Notation*: $X \\sim Uniform(a, b)$\n  - *PDF*: $\\frac{1}{b-a}$\n  - *Mean*: $\\mathbb{E}[X] = \\frac{1}{2}(a + b)$\n  - *Variance*: $var[X] = \\frac{1}{12}(b-a)^2$\n  \n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-10_53a04d1c30edcf508518a919cfebe3e1'}\n\n```{.r .cell-code}\ndf <- tibble(groups = c(\"min = 0, max = 1\",\n                        \"min = -3, max = 0\",\n                        \"min = 1, max = 3\"),\n             mins = c(0, -3, 1),\n             maxes = c(1, 0, 3)) |> \n  crossing(x = seq(from = -4, to = 4, length.out = 1000)) |> \n  mutate(d = dunif(x = x, min = mins, max = maxes))\n\nuniform_pdf <- ggplot(df) +\n  aes(x = x, y = d) +\n  geom_line() +\n  labs(y = \"Probability\") +\n  scale_x_continuous(breaks = -4:4) +\n  facet_wrap(~groups, nrow = 3) +\n  theme_minimal()\n\nuniform_pdf\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n### Beta Distribution {.unnumbered}\n\nThe Beta distribution is used to model data that fall between 0 and 1 (such as proportions). It is very flexible as you can see from the graphs below.\n\n**Properties**:\n\n  - *Notation*: $X \\sim Beta(\\alpha, \\beta)$\n  - *PDF*: $\\frac{x^{\\alpha-1}(1-x)^{\\beta-1}} {\\Beta(\\alpha,\\beta)} \\ \\text{where} \\ \\Beta(\\alpha,\\beta) = \\frac{\\Gamma(\\alpha)\\Gamma(\\beta)}{\\Gamma(\\alpha + \\beta)}$\n  - *Mean*: $\\mathbb{E}[X] = \\frac{\\alpha}{\\alpha + \\beta}$\n  - *Variance*: $var[X] = \\frac{\\alpha\\beta}{(\\alpha+\\beta)^2(\\alpha+\\beta+1)}$\n  \n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-11_23853c0f9be9372e9b76a96baa37ad6c'}\n\n```{.r .cell-code}\ndf <- tibble(groups = c(\"alpha = 0.5. beta = 0.5\",\n                        \"alpha = 1, beta = 1\",\n                        \"alpha = 3, beta = 3\",\n                        \"alpha = 10, beta = 10\"),\n             alpha = c(.75, 1, 3, 10),\n             beta = c(.75, 1, 3, 10)) |> \n  crossing(x = seq(from = 0, to = 1, length.out = 1000)) |> \n  mutate(d = dbeta(x = x, shape1 = alpha, shape2 = beta))\n\nbeta_pdf <- ggplot(df) +\n  aes(x = x, y = d) +\n  geom_line() +\n  labs(y = \"Probability Density\") +\n  scale_x_continuous(breaks = seq(0, 1, by = 0.1)) +\n  facet_wrap(~groups) +\n  theme_minimal()\n\nbeta_pdf\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n## Cumulative Density Functions\n\nWhile probability density functions tell us the probabilities for single values, we are often interested in the probability of a range of values. What is the probability of some value *less than one*? What is the probability of something *between four and seven*? To answer these types of questions using a PDF, we would have to use integration. For example, the area in the graph below corresponds to the following probability:\n\n\n$$\n\\int^{-1}_{-\\infty} Normal(0, 1)\n$$\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-12_cbb40926afdb7c3649c45619f55c08e1'}\n\n```{.r .cell-code}\nstd_normal_pdf +\n  geom_area(aes(fill = x < -1)) +\n  scale_fill_manual(values = c(\"transparent\", \"blue\"), breaks = NULL)\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nCalculating complex integrals like this is hard. Luckily there are functions that already exist which make this easy! Cumulative distribution functions (CDFs) take some value and tell us the probability of getting that value *or less* from a particular distribution. In technical terms, CDFs are the *anti-derivative* of PDFs.\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-13_69335685024dd2b0f95a60451ab940ec'}\n\n```{.r .cell-code}\ndf <- tibble(x = seq(-4, 4, length.out = 1000)) |> \n  mutate(p = pnorm(x, mean = 0, sd = 1))\n\nstd_normal_cdf <- ggplot(df) +\n  aes(x = x, y = p) +\n  geom_line() +\n  scale_x_continuous(breaks = -4:4) +\n  labs(y = \"Cumulative Probability\",\n       title = \"CDF for Normal(0, 1)\") +\n  theme_minimal()\n\nstd_normal_cdf\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nThe height of the solid line tells us the probability of getting a value of `x` or lower.\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-14_c83bbf1ca2c2a9d77cd1b5b92ea1b227'}\n\n```{.r .cell-code}\nstd_normal_cdf +\n  geom_segment(x = 0, y = 0,\n               xend = 0, yend = pnorm(0),\n               linetype = \"dashed\") +\n  geom_segment(x = -4, y = pnorm(0),\n               xend = 0, yend = pnorm(0),\n               linetype = \"dashed\")\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nTo find the probability of a value in a particular range, we can do some eyeball integration as the graph below demonstrates. The probability of a value between 0 and 2 from the distribution $Normal(0, 1)$ is the vertical distance between the dashed lines (a little less than 0.5).\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-15_f06ee62ccdd62c293a4d959c7ad872b5'}\n\n```{.r .cell-code}\nstd_normal_cdf +\n  geom_segment(x = 0, y = 0,\n               xend = 0, yend = pnorm(0),\n               linetype = \"dashed\") +\n  geom_segment(x = -4, y = pnorm(0),\n               xend = 0, yend = pnorm(0),\n               linetype = \"dashed\") +\n  geom_segment(x = 2, y = 0,\n               xend = 2, yend = pnorm(2),\n               linetype = \"dashed\") +\n  geom_segment(x = -4, y = pnorm(2),\n               xend = 2, yend = pnorm(2),\n               linetype = \"dashed\") +\n  geom_segment(x = -2, y = pnorm(2),\n               xend = -2, yend = pnorm(0),\n               arrow = arrow(length = unit(0.03, \"npc\")))\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nTo calculate something like this manually we use the `pfunction()`s in R. For example, the following code tells us the probability of getting a value less than 0 from $Normal(0, 1)$\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-16_71590787ff45e0845c63b316b63d3b5c'}\n\n```{.r .cell-code}\npnorm(0, mean = 0, sd = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5\n```\n:::\n:::\n\n\nWe can subtract one `pfunction()` from another to calculate probabilities over a range of values. The code below gives us the probability of getting a value *between* 1 and -1 from $Normal(0, 1)$\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-17_a913a70639d36973e3dd041a3036232c'}\n\n```{.r .cell-code}\npnorm(1, mean = 0, sd = 1) - pnorm(-1, mean = 0, sd = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6826895\n```\n:::\n:::\n\n\nA graphical representation of this is shown by the shaded areas in the PDF below.\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-18_209857578d3bf9fbf2d3875b154292e2'}\n\n```{.r .cell-code}\nstd_normal_pdf +\n  geom_area(aes(fill = x < -1), alpha = 0.25) +\n  geom_area(aes(fill = x < 1), alpha = 0.5) +\n  scale_fill_manual(values = c(\"transparent\", \"blue\"), breaks = NULL)\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n\n\n## Quantile Functions\n\nThe quantile function is the inverse of the CDF. It takes a cumulative probability as input and returns the corresponding value from the distribution as output. \n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-19_ef211400f435f35b6f686f25f988d610'}\n\n```{.r .cell-code}\ndf <- tibble(q = seq(0, 1, length.out = 1000)) |> \n  mutate(x = qnorm(q, 0, 1))\n\nstd_normal_quantiles <- ggplot(df) + \n  aes(x = q, y = x) +\n  geom_line() +\n  labs(x = \"Percentile\", y = \"Value\") +\n  theme_minimal()\nstd_normal_quantiles\n```\n\n::: {.cell-output-display}\n![](45_distributions_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\nQuantile functions can be useful for calculating the value of something at a specific percentile. The following code calculates the value from a $Normal(0, 1)$ distribution which is at the 99th percentile.\n\n\n::: {.cell hash='45_distributions_cache/html/unnamed-chunk-20_a9d48f185426b51057a6065c221dfb7b'}\n\n```{.r .cell-code}\nqnorm(.99, mean = 0, sd = 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.326348\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}